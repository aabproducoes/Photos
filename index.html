<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>JSON Gallery</title>
<style>
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:sans-serif;background:#000;color:#fff;overflow:hidden}
header{padding:50px 20px;text-align:center}
h1{font-size:2.2rem}

/* ---------- sections ---------- */
.gallery{height:100vh;overflow:hidden;position:relative}

.category{
  height:50vh;                 /* exactly half the viewport */
  padding:20px;
  display:flex;flex-direction:column;gap:12px;
  overflow:hidden;             /* crop anything taller */
}
.category h2{text-align:center;margin-bottom:6px;font-size:1.6rem}

/* grid of square thumbs */
.grid{flex:1;display:grid;gap:12px;
      grid-template-columns:repeat(auto-fit,minmax(200px,1fr))}
.thumb{aspect-ratio:1/1;border-radius:6px;overflow:hidden}
.thumb img{width:100%;height:100%;object-fit:cover}

/* arrows */
.nav{position:fixed;right:12px;top:50%;transform:translateY(-50%);
     display:flex;flex-direction:column;gap:15px}
.nav button{
  width:42px;height:42px;border:none;border-radius:50%;
  font-size:1.3rem;cursor:pointer;
  background:#00bcd4;color:#000;
}
.nav button:disabled{background:#333;color:#777;cursor:not-allowed}
</style>
</head>
<body>

<header><h1>Photos</h1></header>

<div class="gallery" id="gallery"></div>

<div class="nav">
  <button id="up"   disabled>↑</button>
  <button id="down" disabled>↓</button>
</div>

<script>
(async () => {
  /* ---------- load JSON & build DOM ---------- */
  const data    = await fetch('photos.json').then(r => r.json());
  const gallery = document.getElementById('gallery');

  data.categories.forEach(c => {
    const sec = document.createElement('section');
    sec.className = 'category';
    sec.innerHTML = `<h2>${c.name}</h2>
       <div class="grid">
         ${c.photos.map(p =>
            `<div class="thumb">
               <img src="${p.url}" alt="${p.alt}" loading="lazy">
             </div>`).join('')}
       </div>`;
    gallery.appendChild(sec);
  });

  /* ---------- scrolling logic ---------- */
  const cats      = [...document.querySelectorAll('.category')];
  const upBtn     = document.getElementById('up');
  const downBtn   = document.getElementById('down');
  let   index     = 0;                       // current top-most category

  const step      = () => cats[0].offsetHeight;                // 50 vh exact
  const visible   = () => Math.floor(gallery.clientHeight / step());
  const maxIndex  = () => Math.max(0, cats.length - visible()); // last pair

  function updateButtons(){
    upBtn.disabled   = index === 0;
    downBtn.disabled = index === maxIndex();
  }
  function scrollTo(i){
    index = Math.min(Math.max(i,0), maxIndex());
    gallery.scrollTo({top: index * step(), behavior:'smooth'});
    updateButtons();
  }

  upBtn  .addEventListener('click',()=>scrollTo(index-1));
  downBtn.addEventListener('click',()=>scrollTo(index+1));

  /* wheel: throttle to one step every 200 ms */
  let wheelLock = false;
  gallery.addEventListener('wheel',e=>{
    e.preventDefault();
    if(wheelLock) return;
    wheelLock = true; setTimeout(()=>wheelLock=false,200);
    e.deltaY > 0 ? downBtn.click() : upBtn.click();
  },{passive:false});

  /* sync if user drags scrollbar (mobile) */
  gallery.addEventListener('scroll',()=>{
    const newIdx = Math.round(gallery.scrollTop / step());
    if(newIdx !== index){index = newIdx; updateButtons();}
  });

  /* recompute on resize (orientation change) */
  window.addEventListener('resize',()=>{
    gallery.scrollTop = index * step();      // keep same pair visible
    updateButtons();
  });

  /* enable ↓ after layout ready */
  updateButtons();
})();
</script>
</body>
</html>
